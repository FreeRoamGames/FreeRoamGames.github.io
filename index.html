<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VR Malen</title>
  <script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>
</head>
<body>
  <a-scene renderer="antialias: true" background="color: #333">
    <!-- Licht -->
    <a-light type="ambient" intensity="0.5"></a-light>
    <a-light type="directional" intensity="1" position="1 3 2"></a-light>

    <!-- Kugel-H채nde -->
    <a-entity id="left-hand" 
              geometry="primitive: sphere; radius: 0.05" 
              material="color: red; opacity: 0.9" 
              tracked-controls="hand: left; controller: false">
    </a-entity>

    <a-entity id="right-hand" 
              geometry="primitive: sphere; radius: 0.05" 
              material="color: blue; opacity: 0.9" 
              tracked-controls="hand: right; controller: false">
    </a-entity>

    <!-- Kamera -->
    <a-entity camera position="0 1.6 0"></a-entity>
  </a-scene>

  <script>
    AFRAME.registerComponent('draw-lines', {
      schema: { color: { default: 'white' } },
      init: function () {
        const el = this.el;
        const scene = el.sceneEl;
        let isDrawing = false;
        let lastPosition = null;

        // Event: Starten des Zeichnens
        el.addEventListener('triggerdown', () => {
          isDrawing = true;
          lastPosition = el.object3D.position.clone();
        });

        // Event: Beenden des Zeichnens
        el.addEventListener('triggerup', () => {
          isDrawing = false;
          lastPosition = null;
        });

        // Event: Bewegung w채hrend des Zeichnens
        el.addEventListener('controllerconnected', () => {
          el.addEventListener('controllerMoved', () => {
            if (isDrawing && lastPosition) {
              const currentPosition = el.object3D.position.clone();

              // Zeichne eine Linie von der letzten Position zur aktuellen Position
              const line = document.createElement('a-entity');
              line.setAttribute('line', {
                start: lastPosition,
                end: currentPosition,
                color: this.data.color,
                width: 0.01,
              });
              scene.appendChild(line);

              // Update der letzten Position
              lastPosition = currentPosition;
            }
          });
        });
      },
    });

    // F체ge die Komponente zu beiden H채nden hinzu
    document.querySelector('#left-hand').setAttribute('draw-lines', 'color: red');
    document.querySelector('#right-hand').setAttribute('draw-lines', 'color: blue');
  </script>
</body>
</html>
